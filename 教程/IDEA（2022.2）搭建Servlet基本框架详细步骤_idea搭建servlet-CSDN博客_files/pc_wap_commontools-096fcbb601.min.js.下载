$(function(){function e(e){if(f)return void(window.location.href="https://link.csdn.net?from_id="+articleId+"&target="+encodeURIComponent(e));var t=document.createElement("a");t.style.display="none",t.href="https://link.csdn.net?from_id="+articleId+"&target="+encodeURIComponent(e),t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function t(){return!!window.navigator.userAgent.toLowerCase().match(/(csdn)/i)||!!u}function o(e,t){if(void 0!==typeof e&&null!==e&&""!==e)return e=e.toLowerCase(),class_name="hl-1",t&&(class_name="hl-git-1"),class_name}function n(e){return void 0===e||null===e||""===e}function i(e,t){n(t)||(t=t.toLowerCase().replace(/(^\s*)|(\s*$)/g,""),n(t)||(t.indexOf(",")>0?$.each(t.split(","),function(t,o){i(e,o)}):"..."!==t&&t.length>1&&"&nbsp;"!==t&&"csdn"!==t&&"||"!==t&&(e[t]=0)))}function r(e){var t={},o=e.join(",");i(t,o);var n=Object.keys(t);return n.sort(function(e,t){return t.length-e.length}),n}function a(e,n,i){for(var r=(n.html(),""),a=n.context.childNodes,s=0;s<a.length;s++){var c=a[s];if("#text"===c.nodeName){var d=c.textContent.replace(/</gi,"&lt;"),u=/[\u4e00-\u9fa5]/gi,p=e.map(function(e){var t=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return u.test(t)?t:"\\b"+t+"\\b"}),w=new RegExp(p.join("|"),"ig"),f=!1;d=d.replace(w,function(e){var n=e.toLowerCase(),r="https://so.csdn.net/so/search?q="+encodeURIComponent(e)+"&spm=1001.2101.3001.7020";r=t()?"csdnapp://app.csdn.net/search/searchRoot?keyword="+encodeURIComponent(e)+"&t=blog&u="+username+"&from_tracking_code=art_highlight_word&from_code=app_blog_art&backSearch=true":r;var a=t()?'{"key_word":"'+e+'","spm":"1001.2101.3001.7020",}':'{"spm":"1001.2101.3001.7020","dest":"'+r+'","extra":"{\\"searchword\\":\\"'+e+'\\"}"}';return i&&(a='{"spm":"1001.2101.3001.10283","extra":"{\\"words\\":\\"'+e+'\\"}"}'),l[n]>=1||h===n||f?e:(f=!0,l[n]=l[n]?l[n]+1:1,h=n,t()?'<a data-href="'+r+'" class="app-hl hl '+o(n)+'" data-track-view='+a+" data-report-click="+a+">"+e+"</a>":i?'<span class="words-blog '+o(n,"gitcode")+'" data-report-view='+a+" data-tit="+e+" data-pretit="+h+">"+e+"</span>":'<a href="'+r+'" target="_blank" class="hl '+o(n)+'" data-report-view='+a+" data-report-click="+a+" data-tit="+e+" data-pretit="+h+">"+e+"</a>")}),r+=d}else r+=c.outerHTML?c.outerHTML:""}n[0].innerHTML=r,t()?($(window).on("scroll",function(){b.viewCheck()}),b.viewCheck()):window.csdn.report.viewCheck()}function s(){$("a.app-hl").off("click"),$("a.app-hl").click(function(e){e.preventDefault();var t=$(this).data("href"),o=$(this).attr("data-report-click"),n={action:"app_blog_highlight",trackingInfo:o,trackingCode:"art_highlight_word"},i={url:t};w&&(window.jsCallBackListener.csdntrackevent(JSON.stringify(n)),window.jsCallBackListener.csdnjumpnewpage(JSON.stringify(i))),f&&(window.webkit.messageHandlers.csdntrackevent.postMessage(JSON.stringify(n)),window.webkit.messageHandlers.csdnjumpnewpage.postMessage(JSON.stringify(i)))})}function c(){window.keyword_list_init=!0,$.ajax({type:"GET",url:"https://redisdatarecall.csdn.net/recommend/get_head_word?bid=blog-"+articleId,dataType:"json",timeout:2e3,xhrFields:{withCredentials:!0},success:function(e){if(200==e.status&&e.content){var o=r(e.content),n=e.ext?e.ext:{};if(void 0===o||0===o.length)return;var i=[];if(o.forEach(function(e,t){e=e.toLowerCase(),g.indexOf(e)==-1&&i.push(e)}),void 0===i||0===i.length)return;window.keyword_list=i,window.keyword_list_json=n;var c=$("#content_views").find("p,h1,h2,h3,h4,h5,h6");window.keyword_list_doms=c,$.each(c,function(e,t){var t=$(t);a(i,t)}),t()&&s()}}})}function d(){var e=lastTime?lastTime:postTime;e=new Date(e).getTime(),$.ajax({url:"https://clink-api.gitcode.com/api/v1/highlight/get",type:"get",xhrFields:{crossDomain:!0,withCredentials:!0},data:{article_id:articleId,username:username,updated_at:e},success:function(e){},error:function(e){}})}if(!isGitCodeBlog){var l={},h="",u=!!window.isApp&&window.isApp,p=navigator.userAgent,w=p.indexOf("Android")>-1||p.indexOf("Adr")>-1||p.indexOf("OHOS")>-1,f=!!p.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),g=r(privateData)||[];if(!u&&g&&g.length>0){var m=$("#content_views").find("p,h1,h2,h3,h4,h5,h6");$.each(m,function(e,t){var t=$(t);a(g,t,!0)});var v=!0;$(document).on("click",".words-blog",function(){var t=$(this).data("pretit").toLowerCase();v&&(v=!1,$.ajax({url:"https://web-api.gitcode.com/api/v1/search/nauth/project/words",type:"get",data:{words:t},xhrFields:{crossDomain:!0,withCredentials:!0},success:function(o){var n="";200==o.status&&o.data&&o.data[t]?(e(o.data[t]),n=o.data[t]):e("https://gitcode.com?utm_source=highlight_word_gitcode&is_default=1&word="+t),window.csdn.report.reportClick({spm:"1001.2101.3001.10283",extra:{words:t},dest:n}),v=!0},error:function(o){e("https://gitcode.com?utm_source=highlight_word_gitcode&is_default=1&word="+t),v=!0}}))})}var k,b={scrollTop:function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop)},windowHeight:function(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},getElementBottom:function(e){if("undefined"!=typeof jQuery)return $(e).offset().top+$(e).height();var t=e.offsetTop;for(e=e.offsetParent;null!=e;)t+=e.offsetTop,e=e.offsetParent;return t},isView:function(e){var t=this;if(!e)return!1;var o=b.getElementBottom(e),n=o+e.offsetHeight;return t.scrollTop()<o&&o<t.scrollTop()+t.windowHeight()||t.scrollTop()<n&&n<t.scrollTop()+t.windowHeight()},reportView:function(e){console.log("app report exposure",e),w&&(console.log("isAndroid"),window.jsCallBackListener.csdntrackexpo(JSON.stringify(e))),f&&(console.log("isiOS"),window.webkit.messageHandlers.csdntrackexpo.postMessage(JSON.stringify(e)))},viewCheck:function(){clearTimeout(k),k=setTimeout(function(){$("[data-track-view]").each(function(){var e=$(this);if(b.isView(e.get(0))){var t=e.attr("data-track-view"),o={trackingCode:"art_highlight_word",trackingInfo:t,action:"app_blog_highlight"};b.reportView(o),e.removeData("trackView"),e.removeAttr("data-track-view")}})},200)}};c();var _=$("#keywordDecBox");_.length&&($(document).on("mouseover","#article_content .hl",function(){var e=$(this).attr("data-tit"),t=$(this).attr("data-pretit"),o=Object(keyword_list_json)[t];if(e&&o){var n=$(this).offset().left,i=$(this).offset().top,r=$(this).outerHeight(!0),a='<span class="tit">'+e+'</span><span class="dec">'+o+"</span>";_.html(a).css({left:n,top:i+r}).show()}}),$(document).on("mouseout","#article_content .hl",function(){_.hide()}),_.on({mouseover:function(){$(this).show()},mouseout:function(){$(this).hide()}})),u||d()}}),function(){function e(){return!!window.navigator.userAgent.toLowerCase().match(/(phone|pad|pod|iphone|ipod|ios|ipad|android|mobile|blackberry|iemobile|mqqbrowser|juc|fennec|wosbrowser|browserng|webos|symbian|windows phone)/i)}function t(){return!!window.navigator.userAgent.toLowerCase().match(/(csdn)/i)}function o(){var o=null,n=[];if(e())o=document.querySelectorAll('[class^="container-fluid container-fluid-flex container-"]'),n=document.querySelectorAll(".container-fluid.bdinsert");else{if(t())return!1;o=document.querySelectorAll("div[class^='recommend-item-box type_'],div.recommend-item-box.baiduSearch"),n=document.querySelectorAll("div.recommend-item-box.baiduSearch")}o=null!==o?o.length:0;var i=o-n.length;0===i&&$.get("https://statistic.csdn.net/blog/recommend?count="+i+"&baiducount="+n.length+"&articleId="+articleId)}o()}(),function(){function e(){return!!window.navigator.userAgent.toLowerCase().match(/(phone|pad|pod|iphone|ipod|ios|ipad|android|mobile|blackberry|iemobile|mqqbrowser|juc|fennec|wosbrowser|browserng|webos|symbian|windows phone)/i)}function t(){return!!window.navigator.userAgent.toLowerCase().match(/(csdn)/i)}var o=$("#content_views");if($(".vipmaskclassname").length>0){if(!t()){var n="pc";e()&&(n="wap"),window.csdn.report&&"function"==typeof window.csdn.report.reportView&&window.csdn.report.reportView({spm:"3001.10335",extra:{articleId:articleId+"",articleHeight:o.height(),device:n}})}var i=0;400<=o.height()&&o.height()<1500&&(i=o.height()/2),o.height()>=1500&&(i=1e3),i>0?(o.css({height:i+"px",overflow:"hidden"}),$(".vipmaskclassname").show()):$(".vipmaskclassname").remove()}}();